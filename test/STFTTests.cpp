#include <gmock/gmock.h>
#include <gtest/gtest.h>
#include <cfloat>
#include <fftw3.h>
#include <math.h>

extern "C"
{
#include "transform.h"
#include "plot.h"
}

#define DOUBLE_NEAR(x) DoubleNear((x), 4.0 * DBL_EPSILON)
#define DOUBLE_NEAR_MULTIPLIER(x, multiplier) \
  DoubleNear((x), (multiplier)*DBL_EPSILON)


using namespace std;
using namespace testing;

class TestThatSTFT : public Test //class is like a struct
{
 public:
    double epmach = DBL_EPSILON;
    double safmin = DBL_MIN;
    vector<double> sine_test{
        -8.651296230564414e-01,   -2.430309754485042e+00,    1.660141017982664e+00 ,
         1.912177979555350e+00,   -1.501869906392015e+00,    2.494045678993524e+00,
         2.061780713982125e+00,   -3.532825826261877e-01,    8.173445122571842e-01,
         1.047343855806028e+00,    5.776393609322750e-01,    2.140096252990162e+00,
        -1.219958209948431e+00,    3.431935187647062e+00,   -1.843358380045818e+00,
        -1.423193889253535e+00,    9.860431872100537e-01,   -1.990590878503976e-01,
         2.415814379299466e-01,   -8.987235726338194e-01,    1.176606885077754e+00,
        -2.581385053377447e+00,    1.069585537466847e+00,    2.815409296526733e+00,
        -1.402358947926654e+00,    2.415993345656525e+00,    3.858289510540359e+00,
        -1.623120528404219e+00,   -1.699965944421518e+00,    1.483940376943124e+00,
        -1.387556407723196e+00,    1.813956041375389e-01,    3.754669756455393e-01,
         6.088148637744650e-01,    2.396513622560061e+00,    1.588257527659234e+00,
         2.620763639546150e+00,   -2.603101572925668e+00,   -8.191533448269472e-01,
        -1.434573546192443e+00,   -4.159227640297471e+00,    2.491666913157268e-01,
        -1.452806292393381e+00,    4.240922793309156e+00,    3.784600374153735e-02,
         2.345271274216929e+00,    9.790476731775537e-01,   -2.048004595424402e+00,
        -4.927926040434066e+00,   -5.866108589086119e-01,   -2.021267412948497e+00,
         1.697161307657188e+00,    1.602058622507510e+00,    3.589061087094373e+00,
         6.421588460060530e-01,   -2.574975657657524e+00,   -8.873523087074749e-01,
        -3.428870870246049e+00,   -6.991609028301652e-01,    1.690001997486243e-01,
         9.511428999784014e-01,    4.854200460331102e-01,    2.969581706864397e+00,
        -3.549793171904129e+00,    6.172790550309154e-01,    1.540220426128349e+00,
         1.645900564163793e+00,    1.970716475888911e+00,    1.336405665343625e+00,
         2.552777521985762e+00,    1.725585662693919e+00,   -8.529359608906983e-01,
        -1.936900830425247e+00,   -2.156112844497848e+00,   -4.300555679045823e+00,
        -1.168008095312075e+00,    2.556972186303189e-01,    1.061332919155920e+00,
         3.246080054870704e+00,   -7.929281391536369e-01,    6.586824499845164e-01,
         8.321218816293329e-01,    1.448901632558276e+00,   -1.666561462189983e+00,
         1.571563539838429e+00,    2.126820662046308e+00,   -4.449601694839098e-01,
        -5.496530555200647e-01,    2.207915030230729e+00,   -9.515145622940960e-01,
        -1.712955369210800e-01,   -5.220913570045990e-01,   -1.433690240398519e+00,
        -8.411305749529387e-01,    1.203854668329417e+00,   -2.012022344802809e+00,
         7.712904407858717e-01,   -1.989038473917017e-01,   -3.052904988425513e+00,
        -1.432072704656249e+00,   -2.375554032939609e+00,   -3.503782432655730e+00,
         3.382151187037049e+00,    2.995550061487626e-01,    1.445807923132588e+00,
         5.803287734019049e-01,   -2.736154115638901e-01,   -2.285904962935003e+00,
        -1.731532340037214e+00,   -5.079281989416451e-02,   -1.420715911321905e+00,
        -1.423290690643825e+00,    2.901634744919789e+00,   -8.229487850714532e-01,
        -4.005201521281727e+00,   -1.733510783668021e+00,   -3.404180964148781e+00,
        -3.016177095102602e+00,   -8.932499722596182e-02,    2.672906245675865e+00,
         8.450741123857765e-01,    1.403913690268959e+00,   -2.694702295624327e+00,
        -1.352925191378112e+00,   -5.436874501987515e-01,   -1.726304136987824e+00,
        -1.288587328883789e+00,    3.426773654481605e+00,    1.204452712148795e+00,
        -9.486465017555595e-01,    1.023672333932280e+00,   -7.353471252302797e-01,
        -3.235296945470765e+00,    1.864169617993455e+00,    3.950181817719278e-01,
         3.208890631657706e+00,    2.515143516776155e+00,   -1.566464513650459e+00,
        -3.363446319221275e+00,   -1.266991501055774e+00,   -1.612254276080680e+00,
        -1.952697056348854e+00,    1.655678892135153e+00,    4.387620763371445e+00,
         5.550750226000509e-01,   -4.057310754736252e-01,    4.773327167252039e-02,
         1.121846944998504e+00,   -2.294971800761501e+00,   -2.870864840544318e+00,
        -2.397388561147942e-01,    3.376471801830381e-01,    1.557168163656629e+00,
        -9.867804585256147e-01,   -8.397418154912326e-01,   -2.157289114597531e+00,
        -1.806687258182135e+00,    1.659664710679813e+00,   -1.873105282324126e+00,
        -2.429283569661239e+00,    1.889822756027811e+00,   -6.859949367070663e-01,
         8.513335067483762e-01,   -1.056875096555873e+00,    8.317084174388043e-01,
         8.547105185524867e-01,   -2.233950718298257e-01,   -3.293647577885902e+00,
         1.520899064941297e+00,    4.384480554323178e+00,    2.624608829541908e+00,
        -3.502450128233085e+00,   -1.339286758099428e+00,   -2.927652344495465e+00,
        -3.399392782193367e+00,   -3.168706955968521e+00,    5.964215819827480e-01,
        -4.268911767380240e-01,    4.706659465240160e-01,   -8.267257959794225e-01,
        -1.517731986634684e+00,   -2.405418696831774e-02,    1.023687614205699e+00,
         4.541942348440585e+00,   -1.567102250685204e+00,   -3.941637723732623e-01,
         3.646235011310161e+00,    1.548373517934981e-01,   -2.719206124119609e+00,
        -5.742989085882610e-02,    2.155428620735536e+00,    7.177221991007625e-01,
         3.752009720855133e+00,    1.287100736623874e+00,    4.045605730292689e+00,
        -7.918383025374555e-01,   -3.070631599597363e+00,   -1.759072105598761e+00,
         9.710134674694011e-01,   -3.133276517562381e+00,    1.270548269494240e+00,
        -3.019652505482913e-01,    2.511845828682806e+00,   -8.628557705833702e-01,
         9.630539815583442e-01,   -3.896911895474046e+00,   -1.302723524641476e+00,
         6.460799941588337e-01,   -4.792495949227258e-01,    3.171176873367985e+00,
        -3.115027971551462e-01,   -3.961907101363983e+00,   -2.506598190570059e+00,
         1.176860327057799e+00,   -1.797014592610672e+00,   -8.926092709250962e-01,
         7.409062179862778e-01,   -4.558475385346039e+00,   -8.564795821866036e-01,
        -6.426281022009876e-01,   -1.448489180505660e+00,   -2.731850743245827e-01,
         2.682962911840130e+00,   -5.085923601392337e-01,    2.436088433497334e+00,
        -6.924096000657913e-01,    1.365335640381322e+00,   -1.447464265842191e-03,
         2.355840037809388e+00,   -1.607696195109978e-01,    3.724863933927399e-01,
         1.377109220761248e-01,   -1.412419994653569e+00,    9.633434535978617e-01,
         4.434589084599873e+00,    1.300333875837350e+00,    2.155128431568072e-01,
         1.628094292144966e+00,   -6.676928715126021e-01,   -3.335278738180484e+00,
         1.993889833045381e-02,   -2.754519255503380e-01,    1.077038450600531e-01,
         3.963544768913247e+00,    5.374828038504377e+00,    2.426666490196865e-01,
         7.472552217169672e-01,   -1.819499608507670e+00,    7.743001156743520e-01,
        -5.197414905749410e+00,    1.980229744098959e+00,    9.060334516285686e-01,
         1.109901972146340e+00,    2.631090336664030e+00,   -1.089740300755857e+00,
        -1.554054153919509e+00,   -4.189027219552047e+00,   -4.737852727224028e+00,
        -2.067248086843122e+00,    8.272027550858423e-01,   -1.313621435372342e-01,
        -1.545922510944287e+00,    2.924946765069715e+00,   -1.225983561610917e+00,
        -2.616586135207702e-01,   -2.526905746865499e-01,   -3.148866820859811e-01,
         1.608152420650597e+00,    7.277508922622505e-01,   -2.129422607070029e+00,
        -1.470164946795116e+00,    1.445442708223686e-01,   -3.695143135048158e+00,
        -2.258705003957793e+00,   -3.233031054191961e+00,   -3.049120562604889e+00,
        -2.023475829349482e+00,   -3.716186368277665e-01,    7.063949032956764e-01,
        -3.232156491991564e-01,    1.540453045680248e+00,   -1.256747948169557e+00,
        -3.467956511076396e+00,    3.370903271495106e-01,    1.290238965220236e+00,
         2.284128143832174e+00,    2.570217949465584e+00,    3.490604742175353e+00,
        -1.052307169922282e+00,   -1.668983586453920e-01,   -9.774098600421925e-01,
        -1.858593574448111e+00,    4.109857056170717e+00,   -2.372182018674328e-01,
        -2.502509289416306e+00,    3.427987037995726e+00,   -1.399808254494442e-01,
        -3.574904289600852e+00,   -1.687761261419551e-01,    1.638704692388364e+00,
        -1.792085012843864e+00,    1.171209891508000e+00,    1.131396384952111e+00,
        -9.899654488362577e-01,    3.158511874844650e+00,    8.135542414091275e-02,
         7.558897001151594e-01,   -1.710873276891277e+00,   -1.148358989567979e+00,
         1.326791096785642e+00,    1.164684668164317e+00,    4.384947592441515e+00,
        -5.935364747976439e-01,    3.490671709232242e+00,    1.446484898319672e+00,
        -5.541213716133825e+00,   -4.508578790553631e+00,   -1.464690277109369e+00,
         6.124519416195312e-02,    7.838435860193702e-01,    2.261685033967067e+00,
        -1.353562682368405e+00,   -1.802044520499867e+00,   -8.340768314000937e-01,
        -5.973586671238851e-02,    1.257779999824885e+00,    3.466876296235290e+00,
         2.807685189295549e+00,   -2.319267657590243e+00,    1.736340232593640e+00,
         1.035186474341532e+00,    7.409074841711627e-02,    1.364383080713774e+00,
        -1.608067513909457e-01,   -1.529972215014327e+00,   -4.759848265830885e-02,
        -4.658948016454202e+00,    7.483838811093374e-01,   -5.456829157028231e-01,
        -2.303346625792884e+00,   -2.260471866460731e+00,   -2.426765480462638e+00,
         5.646778331737613e-01,    2.169328896142052e+00,    9.873047205379795e-01,
         2.879887499230286e-01,    4.684491119363242e-01,   -5.537220091067681e-01,
        -2.501107209466874e+00,    2.116860590398324e+00,    8.818192856940434e-01,
         3.030117095355291e+00,   -4.088825586002194e-01,   -2.033231928495285e+00,
         1.074892911036469e+00,   -1.205386095015958e+00,   -3.160444023228691e+00,
        -1.588898117177379e+00,   -4.677840207347929e+00,    2.433277853956858e+00,
        -1.011324609993217e+00,   -2.558383264009025e-01,    3.458533192905050e+00,
        -1.620298977254173e+00,   -1.064802948296996e+00,   -1.263382887592248e+00,
         3.423481485555580e+00,    9.768032056402951e-01,   -9.063353782471504e-01,
        -1.050436476397241e+00,    4.059137937505087e+00,    3.533272063426783e+00,
         2.088173517660800e+00,   -4.076218958039379e+00,   -1.777361679752733e+00,
        -1.097864096565424e+00,    6.338058994817617e-01,   -7.129360806043155e-01,
        -1.596233167913053e+00,   -9.845974758120342e-01,    1.576398549497888e+00,
         3.979320544113747e+00,    2.569842331157135e-02,   -2.156242633502081e-01,
         2.550837589347124e+00,    6.758755337155291e-01,    5.295526064510842e+00,
         3.148138669529827e+00,   -2.411806320511625e+00,   -2.028285376516517e+00,
         1.730802388367469e+00,    7.810106231808733e-02,    6.233580681140846e-01,
        -3.136651126235933e+00,    7.722649787307574e-01,    1.259050967818402e+00,
        -2.064653020797502e+00,   -3.342036247305861e+00,   -1.780717750855033e+00,
        -3.008924430391200e+00,   -1.430789778331630e-01,    1.459255841363836e+00,
         4.156027090001151e+00,    1.696507203207780e+00,   -2.929603180369864e-01,
         3.380595909209003e+00,    1.333882613713091e+00,    1.835062551050534e-01,
         1.506027681304051e+00,   -3.180901906714135e-01,    2.663759710975117e+00,
         1.225522063468342e+00,    1.206625228461285e+00,   -3.029112324176416e+00,
         1.500774149064521e+00,   -7.822050405035318e-01,   -4.981764941451885e+00,
         6.222570399995823e-01,    2.981580514547323e+00,    2.043060256812421e+00,
         3.349350205027539e+00,    2.730664374160961e+00,   -2.177922039087268e+00,
        -5.042924936896184e+00,    3.558652944725296e+00,    1.481595616516409e+00,
         1.390934020080146e+00,    7.523846178443448e-01,   -1.887826178214292e+00,
         7.843913343420594e-01,   -3.336742560722140e+00,   -2.877170208434269e+00,
        -1.673062721430706e+00,    6.968242143462287e-01,    5.674830178676582e-01,
        -2.439769415026407e+00,    3.202839983053607e+00,   -1.327150682201582e-01,
         2.961331421495129e+00,   -3.539119996738167e+00,   -2.516320251963596e+00,
        -1.800038826281379e+00,    4.457393542009130e-01,   -5.434735223580756e-01,
        -2.799494210222451e-01,   -3.470559453050547e+00,   -1.135969501470356e+00,
         3.104899232754218e-01,   -9.542450521054420e-01,   -8.034658022657954e-01,
        -2.339778174293779e-01,    8.052115573735923e-01,   -4.158355408235155e-01,
        -1.205951500370499e+00,    4.759230401427013e-01,   -2.129628323835908e+00,
        -1.189760067990466e+00,   -3.329633874348266e+00,   -9.522247402131252e-01,
         1.754517832346668e+00,   -8.299355502550461e-01,    1.399262665840520e+00,
         3.072856349733454e-01,    4.726908531211046e-02,   -9.562313165916424e-01,
        -4.406326226891276e+00,   -1.031055331691033e-01,    3.601684733069388e+00,
         2.559385785421552e+00,    4.443320313118704e-01,   -7.351008666496219e-01,
         1.562708227527440e-01,   -1.948995233813855e+00,   -2.621298232269496e+00,
        -1.239509938794688e+00,    1.807537142133290e+00,   -5.021199734357786e+00,
         1.601427073074177e+00,   -1.657065268446880e+00,    1.797590986648043e+00,
        -5.435699519982478e+00,   -1.213638211663866e+00,   -3.167384834263702e-01,
        -5.316060212154471e-01,    7.416573448268466e-01,   -1.375097441701324e+00,
        -6.821371081536856e-01,   -6.955678667096175e-01,    7.765536633231434e-01,
        -1.860728673325237e+00,    2.123761535789943e+00,   -4.179225131127335e-01,
        -3.888293121194550e+00,   -6.303701645269597e-01,   -9.876005211503330e-01,
         9.442100613762916e-02,   -1.232336038936064e+00,   -1.894911871979447e+00,
        -2.876800431123110e+00,   -1.029926162328869e+00,   -2.888008131756039e+00,
         2.125539586465846e+00,   -1.237529518573415e+00,    1.367178568378780e-02,
         4.988437849022176e-01,    6.083846641610487e-01,   -4.698128040805541e-01,
         3.198323910868052e+00,    3.406703589015323e+00,    1.950937363810401e+00,
         1.134683696746970e+00,   -9.266989366139340e-01,   -9.659993123574564e-01,
        -3.746374837283994e+00,   -2.319625879343255e+00,   -2.592878988982696e+00,
         2.355098017346982e+00,    1.188827226109194e+00,    5.628569318512283e-01,
         1.804468373590625e-01,    7.534309466913400e-01,    1.623361623175714e+00,
         4.114636190030945e+00,    2.220586179583024e-01,    1.707800340841028e+00,
         2.058773203483866e+00,    2.459801919101488e+00,    3.567599479108569e+00,
         3.700693215618476e+00,    4.299472600107979e-01,   -1.216060601783751e+00,
        -7.451838650426013e-01,    7.376062637101559e-01,    1.616821654799041e+00,
        -1.269390719026734e+00,    2.075513200893640e+00,   -1.051947735994599e-01,
        -8.700966179396434e-01,    3.033993236388409e-01,    7.430834784537423e-01,
        -2.091561811349684e+00,   -3.262652534838103e+00,    5.594482757314879e-01,
         2.516689369141928e+00,    1.815022585500207e+00,    4.442832277110428e+00,
        -1.211420785399405e-01,    1.386108317283265e+00,   -2.156177352787349e+00,
        -2.994478184065035e+00,    1.333309972085542e+00,   -2.317029200203093e+00,
        -2.014547877582520e+00,   -1.005842971455355e+00,   -3.517535336708640e+00,
        -1.706993363005644e-01,   -2.202735395066596e+00,   -3.998009341268912e+00,
        -2.437009926528348e+00,   -1.707598374469734e+00,    8.078212274219140e-01,
        -3.708042920631891e+00,   -6.091237929488661e-01,   -2.584590679755197e+00,
         4.202081075053586e-01,    9.460324436881751e-01,    4.783366833762098e-01,
         6.121238018198127e-01,   -4.014184082333264e+00,    1.254705974971168e+00,
        -1.164835000152935e+00,   -8.726000254524848e-01,   -1.837118740000586e+00,
        -3.880833597324711e+00,   -1.901802460310722e-01,   -2.204885455539055e-01,
        -6.829622922417168e-01,    2.215911799612644e+00,    3.515661237812144e+00,
        -2.307326527639735e+00,   -6.396473462438151e-01,   -2.987230785884131e+00,
         1.068790106498465e+00,    1.317956073205406e+00,    1.129714659776593e-01,
         5.326375366585143e-01,    6.382537214132000e-02,    2.786061834864812e+00,
        -4.537155140894648e-01,   -9.881841908967640e-01,   -3.467887271841297e+00,
        -7.282581848692238e-02,    5.217794082572636e+00,    8.574086136679847e-01,
        -2.529058323876038e+00,    3.813566832605129e-01,   -3.662618557151741e+00,
        -1.039678884561446e+00,   -4.795621542703138e+00,    5.375179600619632e-01,
         2.283545661214633e+00,    4.004731553172259e+00,    4.176736633641802e+00,
        -1.793593699407920e-01,    1.676398278096186e+00,    1.934410550382766e+00,
        -2.464718923802322e+00,    1.255077892988068e-01,    1.688486235725107e+00,
        -1.878308824680648e+00,   -9.548671329685426e-01,    2.244864157440090e+00,
        -5.598726303988644e-02,    1.145371703900016e-01,    1.157976976975051e+00,
        -6.869778553126648e-01,   -2.721624925548418e+00,    1.186376523352335e+00,
         9.910242883543041e-02,   -8.664808664550580e-01,    4.775915631304906e+00,
         2.512837271863011e-01,   -2.233653704760759e+00,    8.397627273323156e-01,
         3.345248444344148e+00,    1.887268344595770e+00,    2.930592419163377e+00,
         1.774846317888763e+00,    8.648057961507513e-01,    2.083460032096455e+00,
        -9.773031088597066e-01,   -1.047650175965811e+00,   -2.309047291866617e+00,
        -2.185970544274709e+00,   -7.207611848747166e-01,   -2.125635412735567e+00,
         7.362454504261642e-01,    6.715891067158614e-03,   -8.615879832592857e-01,
        -5.616303575472242e+00,   -1.972609468960763e+00,    2.330435045053637e-01,
         1.398532992697124e+00,    1.769033062601520e+00,    1.573459987581343e+00,
        -1.918834479713885e+00,    1.219150405647450e+00,   -4.664709758589022e-01,
         3.838025330738791e-01,    7.292661856485724e-01,   -1.720617730130761e-01,
         1.118819302999168e+00,   -8.370940739456467e-02,   -4.406970607871316e-01,
        -1.305154578231756e+00,   -3.194527117926648e+00,   -1.180875614290269e+00,
         1.059849479383832e+00,   -1.817202763269004e+00,   -7.376329600459215e-01,
         2.396783548783070e+00,    1.200135919191741e+00,    3.862131760998845e+00,
        -3.203918337561910e+00,   -2.306570106388518e+00,   -1.778471789691613e+00,
         4.536837812736214e+00,    1.678225983081940e+00,    3.682472394943670e-01,
         1.258590883268391e+00,   -4.355648704848669e-02,    1.614046279917213e+00,
        -1.145373171553685e+00,    7.158704300300123e-02,    5.439553339705272e-02,
        -1.162541128598080e+00,   -2.085716156485014e-01,    6.875958695850946e-01,
        -1.239755833189194e+00,   -5.682025749667802e-01,   -7.667117272929219e-01,
        -2.812503696838895e+00,    1.442197597861467e+00,   -1.945816557406823e+00,
        -2.739109365482506e-01,   -6.879452075961328e-01,    3.701440902740623e+00,
        -4.263510389660130e-01,   -3.408220189926201e+00,    9.378840429425519e-01,
         1.932676720289466e+00,    6.464788341566532e-01,    1.145701214313418e-01,
        -1.441051824075793e+00,   -1.187953427008988e+00,    2.347015419950590e+00,
         1.510435911225358e+00,   -2.552875161379681e+00,    2.028394272869207e-01,
        -4.665932970311257e-01,   -7.469221406511143e-01,   -7.632018673857847e-01,
         1.983209007000186e+00,   -2.300958108289853e+00,   -2.355030008920810e+00,
         4.143546109517210e+00,   -4.605117372788468e-01,    4.979802805931918e+00,
        -3.238741086358262e-01,    1.044618558703081e+00,    2.797470670200485e+00,
         3.314091589619386e-01,   -1.086734937565864e+00,    1.929487498035295e+00,
        -3.310801506721134e+00,   -3.597293229716914e-02,   -2.168762524261562e+00,
         1.169406257980321e+00,    2.128674858869577e+00,   -8.938260803357769e-01,
         1.653774119725636e+00,    2.156675489096388e+00,   -2.463111497105365e+00,
         2.925126444802884e-01,   -9.238077828167525e-02,   -1.755271151615559e+00,
         8.000889195670760e-01,    1.243468141554115e+00,   -9.851867184757925e-01,
        -3.566780369708095e+00,   -2.406759767476493e+00,   -1.209756602097639e+00,
        -4.702757377663944e+00,    1.711152724162538e+00,   -1.384852635226860e+00,
        -3.876793113470710e+00,    4.609093714027893e-01,    2.777041170826881e+00,
        -6.735699459719271e-01,   -7.971774609024134e-01,   -1.004812353824573e+00,
         8.171060486880105e-02,    2.424475073369569e+00,    1.775228658584391e+00,
         3.158617656830602e+00,    2.303854357714505e+00,    8.041666135542610e-01,
         3.560068633251200e-01,   -2.552272162885916e+00,   -2.356410072579286e+00,
        -2.611503161807201e-02,    1.176925761714558e+00,   -1.202840600760711e+00,
         1.828423389903758e+00,   -3.213316230623741e-01,    4.175502686785920e+00,
        -8.258685028762683e-01,   -4.024363759384777e+00,    1.074734246148651e-01,
         1.264449135076855e+00,   -7.051465773103360e-02,    1.590983045033378e+00,
        -4.160759995828559e-01,    2.397289804747333e-01,    5.997980252969699e-01,
         2.131150980557693e+00,    1.726414377477325e+00,   -4.473442060134209e+00,
         1.826637397989722e+00,    2.850784384745510e+00,    5.715402672224926e-01,
         1.375231194975733e+00,    3.676135606842359e-01,    1.047552027550633e+00,
         1.112718398738322e+00,    1.217127332941938e+00,   -3.290287837162295e+00,
        -1.549077189868170e+00,    1.729535611065494e+00,   -2.040718690176156e+00,
        -1.801236525231071e+00,    6.076121280618050e-01,   -3.927805364715809e-01,
         2.445223114229824e+00,   -1.534606483359912e+00,    2.610077393558645e+00,
        -1.697381372568031e+00,   -1.950893591487455e+00,    6.308879672088357e-01,
        -9.692433239527812e-01,   -3.211738007457408e+00,   -1.283141675734587e+00,
        -1.327831537984210e+00,   -1.514680523797184e+00,    8.137498541690984e-01,
        -3.091541530409324e+00,   -1.640554703751922e-01,   -5.386993943698164e+00,
        -3.514969953949263e-01,   -2.139172033798621e-01,    1.516385219387044e+00,
        -4.830213667419473e-01,    2.769833509207209e+00,   -8.082569205549923e-01,
         2.590616966572168e+00,   -4.133970053917983e+00,    2.528768596177059e-01,
        -1.744661889722105e+00,   -1.383991468825605e+00,    1.001749016148112e+00,
         2.773702613782429e-01,    2.630036591871777e+00,   -2.577978387395167e-01,
         1.092547309749607e+00,   -2.521260130277698e+00,   -1.513160226201987e+00,
        -3.503090996979489e-01,    1.915030461682590e+00,    1.673780500552454e+00,
         1.906263870095316e-01,   -2.155761408399330e+00,   -1.280758198804965e+00,
         3.043059051208900e-01,   -2.427158463862218e+00,    5.640286498113435e-01,
         2.914156795510253e+00,    1.840203880587986e+00,    1.894290179927518e+00,
         1.994425593761871e+00,    2.773607544375888e+00,    2.309063428913841e+00,
        -3.248874102491079e+00,   -8.449415731247463e-01,    3.627625875152145e-01,
        -7.120331352298392e-01,    5.241692119329957e+00,    1.950982824562069e+00,
        -1.900094610888077e+00,    8.441834563338629e-01,    2.793444823557092e-01,
         5.688201357781163e-01,   -3.691260171155775e+00,    3.734182045617079e+00,
        -1.809053792026600e+00,    3.867078791788415e+00,   -9.316228032647775e-01,
         1.311345114404536e+00,    1.726260240165244e+00,    1.050017400977329e+00,
        -3.941376520395148e-01,   -1.852024800532900e+00,    2.443978806275995e-01,
        -1.019482330477486e+00,   -3.125810542718471e+00,   -2.343207536038774e+00,
        -1.110859097503580e-01,   -5.397082612203468e-01,   -2.240985032998053e+00,
        -5.365498459502374e-01,    1.180304919091782e+00,    1.349084336363960e+00,
         1.636254593586259e+00,    4.941033742675078e+00,   -4.356285667491718e+00,
         4.389573699750259e-01,    3.287312649006008e-01,    1.508507588920055e+00,
        -3.467186867039029e-01,    3.031281413625556e+00,    1.542341231411320e+00,
         2.285428137332029e+00,    1.585892939417482e+00,    1.461873074286771e+00,
        -1.693028431067007e+00,    1.283819503649053e+00,   -2.439653410015502e-01,
        -2.840466795830223e+00,    1.323128393694362e-01,   -6.508715538261638e-01,
        -3.549261620378781e+00,   -1.422729697722714e+00,   -1.995912402776653e+00,
         1.008675106836903e+00,    9.963495952276866e-01,    2.913183403458012e+00,
         2.219546938453259e+00,    1.279483921791092e+00,    7.551446486088795e-01,
         6.216468624989031e-01,    1.641146533990270e+00,    6.604021827687850e-01,
        -3.409352487106470e+00,    7.902600411376992e-02,   -1.663397987544168e-01,
         1.460012369953228e+00,   -7.124956095085211e-01,    1.477480860976691e+00,
        -1.695537955311614e+00,   -4.343609809390139e+00,    1.889832488529324e+00,
         8.816713450918710e-01,    2.031627094600370e+00,    2.223121763032965e-02,
         3.004563630377005e+00,   -3.683683990392627e+00,    2.307502935213100e+00,
        -3.197815211330853e-01,   -3.507162633865422e+00,   -2.294693804215845e+00,
         1.112874731227607e+00,    1.392940518431903e+00,   -1.323630966325689e+00,
        -9.494593023809694e-01,    1.864470081885655e+00,   -2.494494578042931e+00,
        -1.585624706980007e+00,    4.500731658807411e-01,    1.476009564456924e+00,
         7.086616996939568e-01,   -2.472317525976964e+00,   -2.705426202539565e+00,
         9.483924185042146e-01,   -1.833525236436718e+00,    6.981374493953901e-01,
        -2.787140907122354e+00,    1.620535976302729e+00,    2.609053964056280e+00,
         2.324033252052024e+00,   -8.446967927322628e-01,   -3.528404347677137e-01,
         2.960393510837129e-01,   -4.379079732231050e+00,   -2.658611014983825e+00,
        -2.970203072716664e+00,    1.820453471002276e+00,    3.710017541407266e+00,
         1.657151903871038e+00,   -1.693981069023851e+00,   -3.218494566967042e-01,
        -1.568132178077130e+00,   -2.657607039693449e+00,    4.258118268664816e-01,
         8.796685253004197e-01,   -8.554380852722616e-01,    2.817797263251003e-01,
         7.320727957846238e-01,    1.849986034850343e+00,   -2.700989439821504e+00,
        -1.781655113494637e+00,   -1.431860305225942e+00,    1.966744338157042e+00,
         3.992476559847200e+00,    3.441380371724059e+00,    2.027727412646528e+00,
         1.132389784369131e-01,   -1.148548173080290e+00,   -4.647552114264876e+00,
        -2.247086203010163e+00,   -7.022131590267032e-01,    7.222908380688084e-01,
        -1.065335063366975e+00,   -2.081053818435821e-01,    1.895927384956258e+00,
        -2.178896774111927e+00,   -1.790050487914076e+00,    2.910276319746636e-01,
         3.253937195409160e+00,   -1.289563590764635e+00,    2.506894744698622e+00,
        -3.966529979997233e-01,   -3.925873059775331e-02,   -1.546064636350207e+00,
         1.336157726580261e+00,    1.526298850230641e-01,   -5.560870422077846e+00,
        -1.421874361749567e+00,    1.125920992981791e+00,   -2.681052855226072e+00,
        -5.426787847715148e-02,   -9.421137540761992e-01,    3.997712380409406e-01,
        -2.507790576587334e+00,   -2.732229338175158e-01,   -7.256162695964434e-01,
        -1.680228519151566e+00,    8.824701526137777e-01,    6.547221831973259e-01,
         3.514950738861745e-01,   -5.591229029353819e-01,   -3.865702754356608e+00,
         1.237516807107221e+00,    1.950268146984539e+00,   -4.157190409115618e-01,
        -1.196311601473178e+00,    7.439853638474634e-01,   -9.132730162674840e-01,
        -6.611973018556851e-01,   -4.852816322599858e+00,    1.964019642929177e+00,
        -2.460585850851390e-01,    1.431933522152506e+00,    4.098154823404101e+00,
        -2.720005407104030e+00,   -1.504381454991781e-01,    1.143441796958744e+00,
         1.167892410935546e+00,   -1.422852947298887e+00,    3.185436566180228e-01,
        -2.290453809952449e+00,    3.187134008889222e-01,    3.476298996874984e-01,
         2.602427063262190e+00,   -1.110056870337786e+00,   -2.736600078891806e+00,
        -3.355669687068621e+00,   -1.093623486671575e+00,   -2.639106655712532e+00,
         2.889305020004341e+00,    1.581417487144206e+00,    1.407284558799850e+00,
         2.850193139427323e-01,    7.225030329532562e-01,    2.328341648891337e+00,
        -4.907378753055374e+00,    2.567005347986691e+00,   -5.691779232906924e-02,
         1.355329528311031e+00,    3.333620128537579e+00,    2.346863746682981e+00,
        -2.886842692503785e+00,   -3.595116316275587e+00,   -5.142733524151510e-02,
        -3.076851556477425e+00,   -4.077556494277295e+00,   -9.022623925004820e-01,
        -5.441757523145276e-01,   -2.083526674532365e+00,   -2.417863708452320e+00,
        -1.982294762967876e-01,   -4.941616236824533e+00,    1.678480053213133e+00,
         1.065196788015340e+00,    1.099104605276099e-01,    1.364596690516138e+00,
        -1.679261230161906e-01,   -7.995286259425853e-01,    1.287437677578172e+00,
         1.598863410671885e+00,    1.970501262942727e+00,   -7.251478695167861e-01,
         1.225642789502201e+00,    4.381271403096619e+00,    5.119230015755298e+00,
        -5.437159329113586e-01,    3.935671308177542e+00,   -1.606945512450247e+00,
        -3.054589390989077e+00,   -2.836857483855812e-01,   -7.607323703935420e-01,
         2.592627128409986e+00,    2.268673412847304e+00,   -1.979038399977001e+00,
        -5.278662096827857e+00,    1.279343727995831e+00,   -2.257084290313046e+00,
         1.565037867339145e+00,    3.348592486128358e+00,   -1.143174643430735e+00,
         3.271581723718104e+00,    1.515581923787887e+00,   -5.860691000268939e-01,
         2.806518334907213e+00,   -2.215261201202065e+00,    8.912611045594507e-01,
         1.817464852290558e+00,   -4.877900766414840e+00,    5.917898178258055e+00,
         3.143964552018551e+00,    2.459199465420931e+00,   -1.625318839033048e+00,
        -1.103090931093126e+00,   -3.509665736454442e+00,   -2.968189692605631e+00,
        -1.472274585184209e+00,    2.325671091838188e+00,    5.336315047759798e+00,
         4.266501220980158e+00,   -4.806898649291313e-02,   -4.311810748473961e+00,
        -2.145161246503267e-01,   -2.421878998244796e+00,   -4.256904489361415e+00,
         7.333008056386783e-01,    1.440444152067745e+00,    2.029762477195151e+00,
        -6.447412174464680e-01,   -1.626013057715763e+00,   -1.748437388252869e+00,
        -1.758122388032567e+00,   -4.657048728528251e-01,    3.368589366327698e+00,
         1.139915579063454e+00,    2.710811307840640e+00,    5.496946831370573e+00,
         1.126230564314511e-01,    1.572440268944244e+00,    2.713904047286254e-01,
        -1.976233755121004e+00,   -4.904956989516781e+00,   -4.059817378896295e+00,
         2.585048561265835e-01,   -5.333595240593145e-01,   -8.597084567686833e-01,
        -3.765658722475184e+00,   -1.116321717794131e+00,   -1.235108546313260e+00,
        -2.586929791122084e+00,    1.197901519530748e+00,   -2.853392583257041e+00,
        -1.347650701712957e+00,    8.446167053793197e-02,   -2.505902601189014e+00,
         2.107446420530462e+00,    2.557534468880967e+00,    4.530689847476788e-01,
        -2.108717941385374e+00,    2.667868726421331e+00,   -3.548888357821404e+00,
         1.120720241929312e-01,    6.746694248103048e+00,    2.906100190986038e-01,
        -3.498401891727949e+00,    5.177518468320845e-01,   -1.381774733616646e+00,
         1.886686498222427e+00,   -4.786991999456974e-01,    2.923062384783673e+00,
         1.819556073967938e+00,   -3.518254852966890e-01,   -1.719666842703266e+00,
        -4.393581468311885e-01,   -6.470930924792615e-01,    5.020186277026275e-01,
         2.810342236449264e+00,    5.494655309681384e-02,   -3.147817742964878e-01,
         5.252091305172405e-01,   -1.657822244502279e+00,   -3.568380308013220e+00,
         1.272433877922700e+00,   -5.313500131925951e-01,   -2.665155700037700e+00,
        -2.026959151781521e-01,   -8.350826181702042e-02,   -5.208900689850370e+00,
        -4.002863885772690e+00,   -5.279403856660283e+00,    8.062038651739272e-01,
        -9.443691036128756e-01,    2.490955137778418e+00,    2.069584547777636e+00,
         2.077878419447765e+00,   -5.791949389996582e-01,    7.681207012569861e-01,
        -2.904957770440027e+00,   -1.699016913354972e+00,   -1.143214867530731e+00,
         1.211888083996064e+00,   -2.333959103559771e+00,   -1.576745900744986e+00,
         9.833220513969020e-01,    2.597010331831464e+00,   -4.489764877481440e-01,
        -2.449889512650259e+00,   -1.447411810979913e+00,   -5.445829220325910e-01,
         3.934627885902076e+00,    2.860190125579224e-01,    2.236683463251234e+00,
        -2.501951010199815e-01,   -2.189703488194591e+00,   -1.471271857452444e-01,
         1.670774613932425e+00,   -3.010800460391188e+00,   -1.034090797244428e+00,
         1.267595012824882e+00,    2.497369217831976e+00,   -9.138574751546731e-01,
        -1.255989386584226e+00,    5.572712819967416e-01,   -3.621271359394218e+00,
         1.397312095368517e+00,    1.563894808229694e+00,   -1.006806569496255e+00,
         1.636568375177093e+00,    2.476016784207674e+00,   -1.619146841053264e-01,
         3.823208191801624e-01,   -1.152136330218533e+00,   -8.677232714344262e-01,
        -1.456017614995010e-01,   -1.087760694673020e+00,   -8.524021467529508e-02,
         1.275197375734044e+00,    2.767782047096453e+00,   -1.085818514552267e+00,
         2.636739426447085e+00,   -1.905618288732567e+00,    1.452838966066378e+00,
        -1.921773174900820e+00,   -7.837937076638648e-01,   -2.599514102979029e-01,
         4.015096563890559e-01,    2.808209169289418e+00,   -1.350563658561682e+00,
        -2.473738263608523e+00,   -1.250097876114415e-01,   -2.715855043039511e+00,
         2.401570797931272e-01,    1.657609990916265e+00,   -3.864280919478214e-03,
        -2.450139357263352e-01,    2.307113743954536e-05,    4.105216560641676e-01,
         3.336549197870972e+00,    4.693897875641947e+00,    2.744215158722179e+00,
        -1.168425784217280e+00,    1.908053168634355e+00,   -7.924438229733755e-01,
        -2.676093090676203e+00,    1.956791935400488e-01,   -2.877258465846693e-01,
        -1.202503693731299e+00,   -9.401768583447158e-01,   -1.521691255913777e+00,
        -3.441306730255247e+00,   -3.454577658166564e+00,   -3.127151473170474e+00,
        -1.951960717871196e+00,   -6.008808167045231e-01,    1.934248218934200e-01,
        -1.821637639339071e+00,    2.810647738423676e+00,    2.501780512649747e+00,
         4.197392162469454e+00,   -4.799660459748295e-01,   -2.175146766742606e-01,
        -1.637569378151205e+00,    9.671609297493253e-01,    2.176747254086043e+00,
         1.469339781122165e+00,    6.130156448288522e+00,   -1.164170184965560e-01,
         3.185707396374311e-01,   -5.221420169395770e+00,   -2.740064027524869e+00,
        -5.187429277120815e+00,   -8.760445486144842e-01,   -2.366846098428183e+00,
        -3.942071372321521e-01,   -6.835907012366995e-01,    4.699775441651683e-01,
         2.092672015776383e+00,    2.861662793361139e+00,    6.070233809152242e-01,
        -9.376032598085016e-01,    1.173610301226007e+00,   -2.872401731224394e-01,
        -6.881805586607463e-01,   -2.227353540139223e+00,   -4.153906813895305e+00,
        -1.312548975996240e+00,   -2.200409847127385e-01,   -9.379927839516109e-01,
        -7.162483456170912e-01,    5.889109563263890e-02,   -6.851783786434138e-01,
         4.131221794163725e+00,   -5.309287757739179e-01,   -3.416575883566339e+00,
        -1.371597966917246e+00,   -1.572026010298761e+00,    7.463241343914781e-02,
         3.671519368459134e-01,   -3.751768260905264e-02,   -1.904946940573770e+00,
         3.539597166808561e-02,   -3.052540810993721e+00,   -8.800676329445721e-01,
         8.643723335309487e-01,    4.041138349685074e+00,    8.767762725853651e-01,
         1.099066190720352e+00,    2.421717811094699e+00,    7.453528016597806e-01,
         1.799102675569677e+00,   -1.708930490708702e+00,   -1.148009551081359e+00,
        -2.216112894470171e+00,   -1.518534930516032e+00,   -2.894806929286927e-01,
         3.034275626401430e+00,    1.475906797240549e+00,   -2.876301319753221e+00,
         3.766940427560186e+00,    9.916025078634626e-01,   -3.367554695554270e+00,
        -5.874581141225608e-01,    1.113442185676957e+00,   -5.801725601558589e-01,
         4.758048054522360e-01,    6.342136230221982e-01,    1.132486377486237e+00,
        -4.380211544028209e+00,   -3.712196770410501e+00,   -2.434237305263180e+00,
         2.395124745877125e-02,    3.122556569816492e+00,    4.638521480616112e+00,
         2.070456744271902e+00,    1.714937821359302e+00,   -6.446803256890861e-01,
        -6.314318079174310e-01,   -1.619070535839707e+00,    1.686498054934032e+00,
         3.825434228415276e+00,    4.156241147536235e+00,    6.255706918542647e-01,
         7.758995561673088e-01,    6.736706714584433e-01,   -2.295696353835168e+00,
        -7.965143357311606e-01,   -1.043793699905973e-01,    8.585823941873536e-01,
        -9.808846251939016e-01,    2.930694231867762e+00,    1.751657421747510e+00,
        -5.535441936306896e+00,   -3.305776822898802e+00,   -1.602475692814037e+00,
        -4.289897299490390e+00,    3.795460468613725e+00,    1.877314125313877e+00,
         2.940866281269647e+00,   -9.710386895164618e-01,    9.344829661477416e-01,
         3.189537942775155e+00,    8.654901910515813e-01,    1.116816418547748e+00,
         1.206713111869908e+00,    3.514244026479288e-01,   -1.630755312753033e+00,
         4.492660113087322e+00,   -3.246049232490828e+00,   -3.737425551543053e-01,
        -8.656771524008876e-01,    2.735386857759614e+00,   -1.306776308946352e+00,
         3.201706531945713e+00,   -5.374090826341638e-02,    1.540325609971040e+00,
         2.289174253850624e+00,   -1.698190781731753e+00,    9.872259316351504e-01,
         3.269949217235428e+00,    3.615104686688720e-01,    6.006140837383755e+00,
        -9.516198720069924e-02,    6.772207521456199e+00,    5.541315849739764e-01,
         2.016566570588056e-01,   -3.010167513235025e+00,   -5.467080368170606e+00,
        -1.985122973371940e+00,    4.766668533553011e-01,    1.676800370922512e+00,
        -2.917986287496634e+00,   -3.485523337862626e+00,   -9.643029307327677e-01,
        -4.978369824246673e-01,    4.067242868700732e+00,   -1.052661782119449e+00,
         6.927880868738473e-01,    3.042891116165799e+00,    5.996509893562709e-01,
        -6.606440143057100e-01,   -2.250203251776377e+00,    2.393013405210219e+00,
         2.817726549391244e-01,    2.339904399259924e+00,   -1.606531986798972e+00,
         1.854776568125720e+00,    4.376822842915548e+00,    1.520587957535930e+00,
        -7.649554964210609e-02,   -4.011924339282714e+00,    1.140678780966050e+00,
        -4.230264466604217e-02,   -2.462290685999012e+00,    1.061958370278673e+00,
         5.169854425273299e+00,    2.118197748277293e+00,    1.800224695051081e+00,
         3.367033698373214e+00,    8.523805624522107e-02,   -2.983237485656408e+00,
        -1.390701895555255e+00,    1.673952953919456e+00,   -1.125642115528338e+00,
         3.694423798616342e+00,    1.179675363498184e+00,    1.943639588377560e-01,
        -1.650564053353250e-01,   -1.710871369582909e+00,   -2.807675508169139e+00,
        -2.088775587308320e-01,    2.281752934831889e+00,    3.702474327848059e+00,
        -6.396418851792406e-01,    2.202291150424351e+00,   -1.963923707355947e+00,
         2.229928610551521e+00,   -4.018541225562694e-01,    4.186026168957972e-01,
         4.126376922072892e+00,   -2.807323263595102e+00,    1.790172309384978e+00,
        -9.910198842407878e-01,   -2.774976040164761e+00,    6.870258838068668e-01,
        -2.007751513908638e+00,   -2.062428227916252e+00,   -6.468489346122490e-01,
        -1.054684071922833e+00,   -8.741886517513862e-01,    1.995212090698806e+00,
        -1.827487106426699e+00,   -1.296300010150584e+00,   -1.345403681271568e-01,
        -2.556444109495772e+00,   -2.820990728827644e-01,    1.915281548272316e+00,
         1.719403159447336e+00,    6.809496089510136e+00,   -1.324707287975830e+00,
         2.587458639624229e+00,    1.351389634117096e+00,   -2.254345871903852e+00,
        -1.641561851138146e+00,    1.313276223877899e-01,    4.435518281494873e-01,
         4.326039711742707e-01,   -2.912972950935225e+00,    2.864806917234360e+00,
        -2.225754211328342e+00,   -1.458789107287303e+00,   -8.364970941329259e-01,
         1.178567597656820e+00,    1.285713928953341e+00,    1.441935810136235e+00,
        -1.679898877991852e+00,    2.718715396344522e+00,    3.385582793052731e+00,
        -3.114921940273950e+00,   -3.319517222225237e+00,    3.456681338801604e-02,
         9.779206764452155e-01,   -4.307021870394172e-01,    6.931881204715351e-02,
         5.313722098086915e-01,   -2.829049246396298e+00,    2.841159724439140e-01,
        -1.445178919964733e+00,   -1.051998949037663e+00,    2.491714130280592e+00,
        -1.535693107553699e+00,    3.532269532759511e+00,    2.469066681923685e+00,
        -4.242870114355505e-01,    4.118234235884721e-02,    2.073166409572615e+00,
         2.218173876134441e-01,    1.268928030685058e+00,    1.945000985452714e+00,
         1.505516396670370e+00,    4.200134160390874e+00,    2.890995297150647e+00,
         3.487553430727679e+00,   -1.513118743749907e+00,    1.792096008059236e-01,
         7.816361570851721e-01,    2.775167412518949e-01,    2.903630059892161e+00,
         1.574850927426773e+00,   -2.328189335569467e+00,   -1.685075528255955e+00,
        -2.788810597722965e+00,   -7.013855509669777e-01,   -1.914402951203781e+00
        };
  void SetUp() override
  {
      /*
    xvector = (double *)calloc((size_t)n, (size_t)sizeof(double));
    if (xvector == NULL)
    {
      printf("Failed to allocate xvector memory!\n");
      assert(xvector);
    }
       */
  }

  //void TearDown() override { free(xvector); }
};

TEST_F(TestThatSTFT, CanAccessEPMACHandSAFMIN)//this is a sentance
{
  EXPECT_THAT(0.2220446049250313E-15, DOUBLE_NEAR(epmach));
  EXPECT_THAT(0.2225073858507201E-307, DOUBLE_NEAR(safmin));
}

TEST_F(TestThatSTFT, CanFindMaxFrequency )//this is a sentance
{
    
    int size_0pad = 100;
    int n_1 = 0;
    int n_2 = 100000;
    int  N = n_2 - n_1;
    
    sig_filename = "~\cas741_project\test\test_signals\3000.txt"
    in_signal = (double*)malloc(N*sizeof(double));
    
    padded_signal = (double*)malloc((N + 2*size_0pad)*sizeof(double));
    read_signal(sig_filename, in_signal, n_1, n_2);
    zero_pad_signal(in_signal,padded_signal);
    
    double* out_mat = comp_wavelet_transform(padded_signal);
    double df = dominant_frequency(out_mat);
    
    ASSERT_THAT(df, DOUBLE_NEAR(3000));
    

    
}

